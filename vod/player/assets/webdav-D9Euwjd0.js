import{p as e,j as t,aB as a,s as l,aq as n,y as o,H as r,d as u,aH as s,C as i,A as d,I as c,m as v,ak as p,F as m,t as f,b as h,c as g,w as y,aI as b,P as x,e as w,f as S,aJ as k,a2 as V,ac as $,aK as D,R as _,az as C,af as I,ao as M,aG as P,W as B,g as T,aa as A,ae as O,a1 as j,a3 as E,aL as F,aM as z,$ as H,aN as R,aO as U,aP as L,G as N,aQ as Y,aR as G,L as W,aS as q,M as K,i as J}from"./index-2SkDt_TU.js";import{V as Z,b as Q,a as X}from"./VCard-BAwN_RQS.js";import{V as ee,b as te}from"./VBtn-fYrJ95-_.js";import{V as ae}from"./VDialog-Du2IKJGo.js";import{b as le,c as ne,d as oe,e as re,f as ue,g as se,h as ie,u as de,i as ce,p as ve,j as pe,k as me,l as fe,n as he,o as ge,q as ye,r as be,s as xe,t as we,v as Se,w as ke,x as Ve,y as $e,z as De,A as _e,B as Ce,C as Ie,D as Me,E as Pe,F as Be,G as Te,V as Ae}from"./VDataTable-BYFRDRX2.js";import{V as Oe,a as je}from"./VToolbar-VdkbdfVm.js";import{m as Ee,b as Fe,u as ze,V as He,f as Re,d as Ue,e as Le,g as Ne}from"./VInput-BGypikvD.js";import{V as Ye}from"./VIcon-DWjsSruu.js";import{c as Ge,a as We}from"./_commonjsHelpers-BfwKlYae.js";import{_ as qe}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{V as Ke}from"./VDivider-C1bqgPYi.js";import{m as Je,V as Ze}from"./VTextField-7aAJCujH.js";import{u as Qe,t as Xe,V as et,a as tt,b as at}from"./VMenu-CYLIQlau.js";import{V as lt}from"./VAvatar-N9S0wcjS.js";import{V as nt}from"./VSpacer-hV2MslHp.js";import"./loader-B-9DN2BB.js";import"./elevation-DyP75-Bh.js";import"./index-Dt7l_SBc.js";import"./VSlideGroup-DmflEvdz.js";/* empty css              */const ot=e({...t(),...a({variant:"text"})},"VToolbarItems"),rt=l()({name:"VToolbarItems",props:ot(),setup(e,t){let{slots:a}=t;return n({VBtn:{color:o(e,"color"),height:"inherit",variant:o(e,"variant")}}),r((()=>{var t;return u("div",{class:["v-toolbar-items",e.class],style:e.style},[null==(t=a.default)?void 0:t.call(a)])})),{}}}),ut=e({...le(),...ne(),...oe(),...re()},"VDataTableVirtual"),st=l()({name:"VDataTableVirtual",props:ut(),emits:{"update:modelValue":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(e,t){let{attrs:a,slots:l}=t;const{groupBy:p}=ue(e),{sortBy:m,multiSort:f,mustSort:h}=se(e),{disableSort:g}=s(e),{columns:y,headers:b,filterFunctions:x,sortFunctions:w,sortRawFunctions:S}=ie(e,{groupBy:p,showSelect:o(e,"showSelect"),showExpand:o(e,"showExpand")}),{items:k}=de(e,y),V=o(e,"search"),{filteredItems:$}=ce(e,k,V,{transform:e=>e.columns,customKeyFilter:x}),{toggleSort:D}=ve({sortBy:m,multiSort:f,mustSort:h}),{sortByWithGroups:_,opened:C,extractRows:I,isGroupOpen:M,toggleGroup:P}=pe({groupBy:p,sortBy:m,disableSort:g}),{sortedItems:B}=me(e,$,_,{transform:e=>({...e.raw,...e.columns}),sortFunctions:w,sortRawFunctions:S}),{flatItems:T}=fe(B,p,C),A=i((()=>I(T.value))),{isSelected:O,select:j,selectAll:E,toggleSelect:F,someSelected:z,allSelected:H}=he(e,{allItems:A,currentPage:A}),{isExpanded:R,toggleExpand:U}=ge(e),{containerRef:L,markerRef:N,paddingTop:Y,paddingBottom:G,computedItems:W,handleItemResize:q,handleScroll:K,handleScrollend:J}=ye(e,T),Z=i((()=>W.value.map((e=>e.raw))));be({sortBy:m,page:d(1),itemsPerPage:d(-1),groupBy:p,search:V}),n({VDataTableRows:{hideNoData:o(e,"hideNoData"),noDataText:o(e,"noDataText"),loading:o(e,"loading"),loadingText:o(e,"loadingText")}});const Q=i((()=>({sortBy:m.value,toggleSort:D,someSelected:z.value,allSelected:H.value,isSelected:O,select:j,selectAll:E,toggleSelect:F,isExpanded:R,toggleExpand:U,isGroupOpen:M,toggleGroup:P,items:A.value.map((e=>e.raw)),internalItems:A.value,groupedItems:T.value,columns:y.value,headers:b.value})));r((()=>{const t=xe.filterProps(e),n=we.filterProps(e),o=Se.filterProps(e);return u(Se,v({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},o),{top:()=>{var e;return null==(e=l.top)?void 0:e.call(l,Q.value)},wrapper:()=>{var o,r,s;return u("div",{ref:L,onScrollPassive:K,onScrollend:J,class:"v-table__wrapper",style:{height:c(e.height)}},[u("table",null,[null==(o=l.colgroup)?void 0:o.call(l,Q.value),!e.hideDefaultHeader&&u("thead",{key:"thead"},[u(xe,v(t,{sticky:e.fixedHeader}),l)]),!e.hideDefaultBody&&u("tbody",null,[u("tr",{ref:N,style:{height:c(Y.value),border:0}},[u("td",{colspan:y.value.length,style:{height:0,border:0}},null)]),null==(r=l["body.prepend"])?void 0:r.call(l,Q.value),u(we,v(a,n,{items:Z.value}),{...l,item:e=>u(ke,{key:e.internalItem.index,renderless:!0,"onUpdate:height":t=>q(e.internalItem.index,t)},{default:t=>{var a;let{itemRef:n}=t;return(null==(a=l.item)?void 0:a.call(l,{...e,itemRef:n}))??u(Ve,v(e.props,{ref:n,key:e.internalItem.index,index:e.internalItem.index}),l)}})}),null==(s=l["body.append"])?void 0:s.call(l,Q.value),u("tr",{style:{height:c(G.value),border:0}},[u("td",{colspan:y.value.length,style:{height:0,border:0}},null)])])])])},bottom:()=>{var e;return null==(e=l.bottom)?void 0:e.call(l,Q.value)}})}))}}),it=e({itemsLength:{type:[Number,String],required:!0},...$e(),...le(),...De()},"VDataTableServer"),dt=l()({name:"VDataTableServer",props:it(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,t){let{attrs:a,slots:l}=t;const{groupBy:d}=ue(e),{sortBy:c,multiSort:f,mustSort:h}=se(e),{page:g,itemsPerPage:y}=_e(e),{disableSort:b}=s(e),x=i((()=>parseInt(e.itemsLength,10))),{columns:w,headers:S}=ie(e,{groupBy:d,showSelect:o(e,"showSelect"),showExpand:o(e,"showExpand")}),{items:k}=de(e,w),{toggleSort:V}=ve({sortBy:c,multiSort:f,mustSort:h,page:g}),{opened:$,isGroupOpen:D,toggleGroup:_,extractRows:C}=pe({groupBy:d,sortBy:c,disableSort:b}),{pageCount:I,setItemsPerPage:M}=Ce({page:g,itemsPerPage:y,itemsLength:x}),{flatItems:P}=fe(k,d,$),{isSelected:B,select:T,selectAll:A,toggleSelect:O,someSelected:j,allSelected:E}=he(e,{allItems:k,currentPage:k}),{isExpanded:F,toggleExpand:z}=ge(e),H=i((()=>C(k.value)));be({page:g,itemsPerPage:y,sortBy:c,groupBy:d,search:o(e,"search")}),p("v-data-table",{toggleSort:V,sortBy:c}),n({VDataTableRows:{hideNoData:o(e,"hideNoData"),noDataText:o(e,"noDataText"),loading:o(e,"loading"),loadingText:o(e,"loadingText")}});const R=i((()=>({page:g.value,itemsPerPage:y.value,sortBy:c.value,pageCount:I.value,toggleSort:V,setItemsPerPage:M,someSelected:j.value,allSelected:E.value,isSelected:B,select:T,selectAll:A,toggleSelect:O,isExpanded:F,toggleExpand:z,isGroupOpen:D,toggleGroup:_,items:H.value.map((e=>e.raw)),internalItems:H.value,groupedItems:P.value,columns:w.value,headers:S.value})));r((()=>{const t=Ie.filterProps(e),n=xe.filterProps(e),o=we.filterProps(e),r=Se.filterProps(e);return u(Se,v({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},r),{top:()=>{var e;return null==(e=l.top)?void 0:e.call(l,R.value)},default:()=>{var t,r,s,i,d,c;return l.default?l.default(R.value):u(m,null,[null==(t=l.colgroup)?void 0:t.call(l,R.value),!e.hideDefaultHeader&&u("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[u(xe,v(n,{sticky:e.fixedHeader}),l)]),null==(r=l.thead)?void 0:r.call(l,R.value),!e.hideDefaultBody&&u("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[null==(s=l["body.prepend"])?void 0:s.call(l,R.value),l.body?l.body(R.value):u(we,v(a,o,{items:P.value}),l),null==(i=l["body.append"])?void 0:i.call(l,R.value)]),null==(d=l.tbody)?void 0:d.call(l,R.value),null==(c=l.tfoot)?void 0:c.call(l,R.value)])},bottom:()=>l.bottom?l.bottom(R.value):!e.hideDefaultFooter&&u(m,null,[u(Ke,null,null),u(Ie,t,{prepend:l["footer.prepend"]})])})}))}}),ct={__name:"Confirm",props:{modelValue:{type:Boolean,required:!1},title:{type:String,required:!0,default:"提示"},text:{type:String,required:!0},confirm:{type:Function}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=f(!1),n=e=>{e.value=!1,o("update:modelValue",!1)},o=t;return(t,o)=>(h(),g(ae,{"model-value":e.modelValue,"max-width":"400",persistent:""},{activator:y((({props:e})=>[b(t.$slots,"btn",{dialog:e})])),default:y((({isActive:t})=>[u(Z,{title:e.title,text:e.text},{default:y((()=>[u(Q,null,{default:y((()=>[u(ee,{color:"grey",onClick:x((e=>n(t)),["stop"])},{default:y((()=>o[0]||(o[0]=[w("取消")]))),_:2},1032,["onClick"]),u(ee,{color:"primary",loading:S(l),disabled:S(l),onClick:x((e=>(async e=>{if(!a.confirm)return n(e);const t="AsyncFunction"===a.confirm.constructor.name;try{l.value=!0,t?await a.confirm():a.confirm(),n(e)}finally{l.value=!1}})(t)),["stop"])},{default:y((()=>o[1]||(o[1]=[w(" 确认 ")]))),_:2},1032,["loading","disabled","onClick"])])),_:2},1024)])),_:2},1032,["title","text"])])),_:3},8,["model-value"]))}},vt=e({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>"boolean"==typeof e||[1e3,1024].includes(+e)},...Ee({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>k(e).every((e=>null!=e&&"object"==typeof e))},...Fe({clearable:!0})},"VFileInput"),pt=l()({name:"VFileInput",inheritAttrs:!1,props:vt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){function a(){var e;E.value!==document.activeElement&&(null==(e=E.value)||e.focus()),y.value||b()}function l(e){var t;null==(t=E.value)||t.click()}function n(e){c("mousedown:control",e)}function o(e){var t;null==(t=E.value)||t.click(),c("click:control",e)}function s(t){t.stopPropagation(),a(),M((()=>{g.value=[],P(e["onClick:clear"],t)}))}let{attrs:d,emit:c,slots:p}=t;const{t:h}=V(),g=$(e,"modelValue",e.modelValue,(e=>k(e)),(t=>!e.multiple&&Array.isArray(t)?t[0]:t)),{isFocused:y,focus:b,blur:x}=ze(e),w=i((()=>"boolean"!=typeof e.showSize?e.showSize:void 0)),S=i((()=>(g.value??[]).reduce(((e,t)=>{let{size:a=0}=t;return e+a}),0))),B=i((()=>D(S.value,w.value))),T=i((()=>(g.value??[]).map((t=>{const{name:a="",size:l=0}=t;return e.showSize?`${a} (${D(l,w.value)})`:a})))),A=i((()=>{var t;const a=(null==(t=g.value)?void 0:t.length)??0;return e.showSize?h(e.counterSizeString,a,B.value):h(e.counterString,a)})),O=f(),j=f(),E=f(),F=i((()=>y.value||e.active)),z=i((()=>["plain","underlined"].includes(e.variant)));return _(g,(e=>{(!Array.isArray(e)||!e.length)&&E.value&&(E.value.value="")})),r((()=>{const t=!(!p.counter&&!e.counter),r=!(!t&&!p.details),[i,c]=C(d),{modelValue:f,...h}=He.filterProps(e),b=Re(e);return u(He,v({ref:O,modelValue:g.value,"onUpdate:modelValue":e=>g.value=e,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":z.value},e.class],style:e.style,"onClick:prepend":l},i,h,{centerAffix:!z.value,focused:y.value}),{...p,default:t=>{let{id:l,isDisabled:r,isDirty:i,isReadonly:d,isValid:f}=t;return u(Ue,v({ref:j,"prepend-icon":e.prependIcon,onMousedown:n,onClick:o,"onClick:clear":s,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},b,{id:l.value,active:F.value||i.value,dirty:i.value||e.dirty,disabled:r.value,focused:y.value,error:!1===f.value}),{...p,default:t=>{var l;let{props:{class:n,...o}}=t;return u(m,null,[u("input",v({ref:E,type:"file",readonly:d.value,disabled:r.value,multiple:e.multiple,name:e.name,onClick:e=>{e.stopPropagation(),d.value&&e.preventDefault(),a()},onChange:e=>{e.target&&(g.value=[...e.target.files??[]])},onFocus:a,onBlur:x},o,c),null),u("div",{class:n},[!!(null==(l=g.value)?void 0:l.length)&&!e.hideInput&&(p.selection?p.selection({fileNames:T.value,totalBytes:S.value,totalBytesReadable:B.value}):e.chips?T.value.map((e=>u(Me,{key:e,size:"small",text:e},null))):T.value.join(", "))])])}})},details:r?a=>{var l,n;return u(m,null,[null==(l=p.details)?void 0:l.call(p,a),t&&u(m,null,[u("span",null,null),u(Le,{active:!!(null==(n=g.value)?void 0:n.length),value:A.value,disabled:e.disabled},p.counter)])])}:void 0})})),I({},O,j,E)}}),mt={class:"text-center pa-4"},ft={__name:"ImportLines",setup(e){const t=B("axios"),a=d(!1);_(a,(e=>{e||(r.value=[],l.value=null)}));const l=f(null),n=[{title:"序号",key:"id",width:100},{title:"链接",key:"link",width:280},{title:"名称",key:"name",width:260},{title:"状态",key:"status",width:100},{title:"错误",key:"error"}],o=f(!1),r=f([]),s=async e=>{try{(await t.post("/webdav/manage/list",e.map((e=>(e.loading=!0,e.link))))).forEach(((t,a)=>Object.assign(e[a],t)))}catch(a){e.forEach((e=>{e.success=!1,e.error=a.message||"导入失败"}))}finally{e.forEach((e=>e.loading=!1))}},i=async()=>{if(0===r.value.length)return;o.value=!0;const e=new Set;for(let t=0;r.value.length>t;t+=5){const a=r.value.slice(t,t+5),l=s(a);e.add(l),l.finally((()=>e.delete(l))),2>e.size||await Promise.race(e)}await Promise.all(e),o.value=!1},c=async e=>{const t=e.target.files[0];if(!t)return;const a=new TextDecoder("utf-8"),l=t.stream().getReader();let{value:n,done:o}=await l.read(),u="",s=0;for(;!o;){u+=a.decode(n,{stream:!0});let e=u.split(/\r?\n/);u=e.pop();for(let t of e)t=t.trim(),t&&r.value.push({id:++s,link:t});({value:n,done:o}=await l.read())}u&&(u=u.trim(),u&&r.value.push({id:++s,link:u}))};return(e,t)=>(h(),T("div",mt,[u(ae,{modelValue:S(a),"onUpdate:modelValue":t[2]||(t[2]=e=>A(a)?a.value=e:null),transition:"dialog-bottom-transition",fullscreen:""},{activator:y((({props:e})=>[u(ee,v({class:"mr-2",icon:"mdi-import",density:"comfortable",variant:"text"},e),null,16)])),default:y((()=>[u(st,{class:"h-100",headers:n,items:S(r),hover:"",fixedHeader:""},{top:y((()=>[u(Oe,{flat:"",density:"compact"},{default:y((()=>[u(je,null,{default:y((()=>t[3]||(t[3]=[w("导入分享数据")]))),_:1}),u(rt,null,{default:y((()=>[u(pt,{ref_key:"inputFile",ref:l,accept:".txt",class:"d-none",onChange:c},null,512),u(ee,{text:"加载文件",variant:"text",onClick:t[0]||(t[0]=e=>S(l).click()),disabled:S(o)},null,8,["disabled"]),u(ee,{text:"开始任务",variant:"text",onClick:i,loading:S(o)},null,8,["loading"])])),_:1}),u(ee,{icon:"mdi-close",onClick:t[1]||(t[1]=e=>a.value=!1),disabled:S(o)},null,8,["disabled"])])),_:1})])),"item.status":y((({item:e})=>[e.loading?(h(),g(te,{key:0,size:18,width:2,color:"green",indeterminate:""})):e.success?(h(),g(Ye,{key:1,icon:"mdi-check",color:"green"})):!1===e.success?(h(),g(Ye,{key:2,icon:"mdi-close",color:"red"})):(h(),g(Ye,{key:3,icon:"mdi-help",color:"grey"}))])),_:1},8,["items"])])),_:1},8,["modelValue"])]))}},ht=We({exports:{}}.exports=function(){var e=6e4,t=36e5,a="millisecond",l="second",n="minute",o="hour",r="day",u="week",s="month",i="quarter",d="year",c="date",v="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(e,t,a){var l=e+"";return l&&t>l.length?""+Array(t+1-l.length).join(a)+e:e},h={s:f,z:function(e){var t=-e.utcOffset(),a=Math.abs(t),l=a%60;return(t>0?"-":"+")+f(Math.floor(a/60),2,"0")+":"+f(l,2,"0")},m:function e(t,a){if(t.date()<a.date())return-e(a,t);var l=12*(a.year()-t.year())+(a.month()-t.month()),n=t.clone().add(l,s),o=0>a-n,r=t.clone().add(l+(o?-1:1),s);return+(-(l+(a-n)/(o?n-r:r-n))||0)},a:function(e){return 0>e?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:s,y:d,w:u,d:r,D:c,h:o,m:n,s:l,ms:a,Q:i}[e]||((e||"")+"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},g="en",y={};y[g]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],a=e%100;return"["+e+(t[(a-20)%10]||t[a]||"th")+"]"}};var b="$isDayjsObject",x=function(e){return e instanceof V||!(!e||!e[b])},w=function e(t,a,l){var n;if(!t)return g;if("string"==typeof t){var o=t.toLowerCase();y[o]&&(n=o),a&&(y[o]=a,n=o);var r=t.split("-");if(!n&&r.length>1)return e(r[0])}else{var u=t.name;y[u]=t,n=u}return!l&&n&&(g=n),n||!l&&g},S=function(e,t){if(x(e))return e.clone();var a="object"==typeof t?t:{};return a.date=e,a.args=arguments,new V(a)},k=h;k.l=w,k.i=x,k.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var V=function(){function f(e){this.$L=w(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[b]=!0}var h=f.prototype;return h.parse=function(e){this.$d=function(e){var t=e.date,a=e.utc;if(null===t)return new Date(NaN);if(k.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var l=t.match(p);if(l){var n=l[2]-1||0,o=(l[7]||"0").substring(0,3);return a?new Date(Date.UTC(l[1],n,l[3]||1,l[4]||0,l[5]||0,l[6]||0,o)):new Date(l[1],n,l[3]||1,l[4]||0,l[5]||0,l[6]||0,o)}}return new Date(t)}(e),this.init()},h.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},h.$utils=function(){return k},h.isValid=function(){return!(""+this.$d===v)},h.isSame=function(e,t){var a=S(e);return this.startOf(t)<=a&&a<=this.endOf(t)},h.isAfter=function(e,t){return S(e)<this.startOf(t)},h.isBefore=function(e,t){return this.endOf(t)<S(e)},h.$g=function(e,t,a){return k.u(e)?this[t]:this.set(a,e)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(e,t){var a=this,i=!!k.u(t)||t,v=k.p(e),p=function(e,t){var l=k.w(a.$u?Date.UTC(a.$y,t,e):new Date(a.$y,t,e),a);return i?l:l.endOf(r)},m=function(e,t){return k.w(a.toDate()[e].apply(a.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),a)},f=this.$W,h=this.$M,g=this.$D,y="set"+(this.$u?"UTC":"");switch(v){case d:return i?p(1,0):p(31,11);case s:return i?p(1,h):p(0,h+1);case u:var b=this.$locale().weekStart||0,x=(b>f?f+7:f)-b;return p(i?g-x:g+(6-x),h);case r:case c:return m(y+"Hours",0);case o:return m(y+"Minutes",1);case n:return m(y+"Seconds",2);case l:return m(y+"Milliseconds",3);default:return this.clone()}},h.endOf=function(e){return this.startOf(e,!1)},h.$set=function(e,t){var u,i=k.p(e),v="set"+(this.$u?"UTC":""),p=(u={},u[r]=v+"Date",u[c]=v+"Date",u[s]=v+"Month",u[d]=v+"FullYear",u[o]=v+"Hours",u[n]=v+"Minutes",u[l]=v+"Seconds",u[a]=v+"Milliseconds",u)[i],m=i===r?this.$D+(t-this.$W):t;if(i===s||i===d){var f=this.clone().set(c,1);f.$d[p](m),f.init(),this.$d=f.set(c,Math.min(this.$D,f.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},h.set=function(e,t){return this.clone().$set(e,t)},h.get=function(e){return this[k.p(e)]()},h.add=function(a,i){var c,v=this;a=+a;var p=k.p(i),m=function(e){var t=S(v);return k.w(t.date(t.date()+Math.round(e*a)),v)};if(p===s)return this.set(s,this.$M+a);if(p===d)return this.set(d,this.$y+a);if(p===r)return m(1);if(p===u)return m(7);var f=(c={},c[n]=e,c[o]=t,c[l]=1e3,c)[p]||1,h=this.$d.getTime()+a*f;return k.w(h,this)},h.subtract=function(e,t){return this.add(-1*e,t)},h.format=function(e){var t=this,a=this.$locale();if(!this.isValid())return a.invalidDate||v;var l=e||"YYYY-MM-DDTHH:mm:ssZ",n=k.z(this),o=this.$H,r=this.$m,u=this.$M,s=a.weekdays,i=a.months,d=function(e,a,n,o){return e&&(e[a]||e(t,l))||n[a].slice(0,o)},c=function(e){return k.s(o%12||12,e,"0")},p=a.meridiem||function(e,t,a){var l=12>e?"AM":"PM";return a?l.toLowerCase():l};return l.replace(m,(function(e,l){return l||function(e){switch(e){case"YY":return(t.$y+"").slice(-2);case"YYYY":return k.s(t.$y,4,"0");case"M":return u+1;case"MM":return k.s(u+1,2,"0");case"MMM":return d(a.monthsShort,u,i,3);case"MMMM":return d(i,u);case"D":return t.$D;case"DD":return k.s(t.$D,2,"0");case"d":return t.$W+"";case"dd":return d(a.weekdaysMin,t.$W,s,2);case"ddd":return d(a.weekdaysShort,t.$W,s,3);case"dddd":return s[t.$W];case"H":return o+"";case"HH":return k.s(o,2,"0");case"h":return c(1);case"hh":return c(2);case"a":return p(o,r,!0);case"A":return p(o,r,!1);case"m":return r+"";case"mm":return k.s(r,2,"0");case"s":return t.$s+"";case"ss":return k.s(t.$s,2,"0");case"SSS":return k.s(t.$ms,3,"0");case"Z":return n}return null}(e)||n.replace(":","")}))},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(a,c,v){var p,m=this,f=k.p(c),h=S(a),g=(h.utcOffset()-this.utcOffset())*e,y=this-h,b=function(){return k.m(m,h)};switch(f){case d:p=b()/12;break;case s:p=b();break;case i:p=b()/3;break;case u:p=(y-g)/6048e5;break;case r:p=(y-g)/864e5;break;case o:p=y/t;break;case n:p=y/e;break;case l:p=y/1e3;break;default:p=y}return v?p:k.a(p)},h.daysInMonth=function(){return this.endOf(s).$D},h.$locale=function(){return y[this.$L]},h.locale=function(e,t){if(!e)return this.$L;var a=this.clone(),l=w(e,t,!0);return l&&(a.$L=l),a},h.clone=function(){return k.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},f}(),$=V.prototype;return S.prototype=$,[["$ms",a],["$s",l],["$m",n],["$H",o],["$W",r],["$M",s],["$y",d],["$D",c]].forEach((function(e){$[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,V,S),e.$i=!0),S},S.locale=w,S.isDayjs=x,S.unix=function(e){return S(1e3*e)},S.en=y[g],S.Ls=y,S.p={},S}()),gt=e({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...re({filterKeys:["title"]}),...Pe({hideNoData:!0,returnObject:!0}),...O(Je({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...j({transition:!1})},"VCombobox"),yt=l()({name:"VCombobox",props:gt(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,t){function a(t){W=!0,e.openOnClear&&(Y.value=!0)}function l(){me.value||(Y.value=!0)}function n(e){me.value||(B.value&&(e.preventDefault(),e.stopPropagation()),Y.value=!Y.value)}function o(e){var t;U(e)&&(null==(t=P.value)||t.focus())}function s(t){var a;if(L(t)||e.readonly||(null==ae?void 0:ae.isReadonly.value))return;const l=P.value.selectionStart,n=te.value.length;if((G.value>-1||["Enter","ArrowDown","ArrowUp"].includes(t.key))&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(Y.value=!0),["Escape"].includes(t.key)&&(Y.value=!1),["Enter","Escape","Tab"].includes(t.key)&&(pe.value&&["Enter","Tab"].includes(t.key)&&!te.value.some((e=>{let{value:t}=e;return t===de.value[0].value}))&&h(se.value[0]),T.value=!0),"ArrowDown"===t.key&&pe.value&&(null==(a=fe.value)||a.focus("next")),"Enter"===t.key&&re.value&&(h(Xe(e,re.value)),ne.value&&(oe.value="")),["Backspace","Delete"].includes(t.key)){if(!e.multiple&&ne.value&&te.value.length>0&&!re.value)return h(te.value[0],!1);if(~G.value){const e=G.value;h(te.value[G.value],!1),G.value=n-1>e?e:n-2}else"Backspace"!==t.key||re.value||(G.value=n-1)}if(e.multiple){if("ArrowLeft"===t.key){if(0>G.value&&l>0)return;const e=G.value>-1?G.value-1:n-1;te.value[e]?G.value=e:(G.value=-1,P.value.setSelectionRange(re.value.length,re.value.length))}if("ArrowRight"===t.key){if(0>G.value)return;const e=G.value+1;te.value[e]?G.value=e:(G.value=-1,P.value.setSelectionRange(0,0))}}}function c(){var t;e.eager&&(null==(t=j.value)||t.calculateVisibleItems())}function p(){var e;B.value&&(T.value=!0,null==(e=P.value)||e.focus())}function h(t){let a=1>=arguments.length||void 0===arguments[1]||arguments[1];if(t&&!t.props.disabled)if(e.multiple){const l=te.value.findIndex((a=>e.valueComparator(a.value,t.value))),n=null==a?!~l:a;if(~l){const e=n?[...te.value,t]:[...te.value];e.splice(l,1),te.value=e}else n&&(te.value=[...te.value,t]);e.clearOnSelect&&(re.value="")}else{const e=!1!==a;te.value=e?[t]:[],oe.value=e&&!ne.value?t.title:"",M((()=>{Y.value=!1,T.value=!0}))}}function g(e){B.value=!0,setTimeout((()=>{A.value=!0}))}function y(e){A.value=!1}function b(t){null!=t&&(""!==t||e.multiple||ne.value)||(te.value=[])}var x;let{emit:S,slots:D}=t;const{t:C}=V(),P=f(),B=d(!1),T=d(!0),A=d(!1),O=f(),j=f(),N=$(e,"menu"),Y=i({get:()=>N.value,set:e=>{var t;N.value&&!e&&(null==(t=O.value)?void 0:t.ΨopenChildren.size)||(N.value=e)}}),G=d(-1);let W=!1;const q=i((()=>{var e;return null==(e=P.value)?void 0:e.color})),K=i((()=>Y.value?e.closeText:e.openText)),{items:J,transformIn:Z,transformOut:Q}=Qe(e),{textColorClasses:X,textColorStyles:ee}=E(q),te=$(e,"modelValue",[],(e=>Z(k(e))),(t=>{const a=Q(t);return e.multiple?a:a[0]??null})),ae=Ne(),le=i((()=>!(!e.chips&&!D.chip))),ne=i((()=>le.value||!!D.selection)),oe=d(e.multiple||ne.value?"":(null==(x=te.value[0])?void 0:x.title)??""),re=i({get:()=>oe.value,set:t=>{var a;if(oe.value=t??"",e.multiple||ne.value||(te.value=[Xe(e,t)]),t&&e.multiple&&(null==(a=e.delimiters)?void 0:a.length)){const a=t.split(RegExp(`(?:${e.delimiters.join("|")})+`));a.length>1&&(a.forEach((t=>{(t=t.trim())&&h(Xe(e,t))})),oe.value="")}t||(G.value=-1),T.value=!t}}),ue=i((()=>"function"==typeof e.counterValue?e.counterValue(te.value):"number"==typeof e.counterValue?e.counterValue:e.multiple?te.value.length:re.value.length));_(oe,(e=>{W?M((()=>W=!1)):B.value&&!Y.value&&(Y.value=!0),S("update:search",e)})),_(te,(t=>{var a;e.multiple||ne.value||(oe.value=(null==(a=t[0])?void 0:a.title)??"")}));const{filteredItems:se,getMatches:ie}=ce(e,J,(()=>T.value?"":re.value)),de=i((()=>e.hideSelected?se.value.filter((e=>!te.value.some((t=>t.value===e.value)))):se.value)),ve=i((()=>te.value.map((e=>e.value)))),pe=i((()=>{var t;return(!0===e.autoSelectFirst||"exact"===e.autoSelectFirst&&re.value===(null==(t=de.value[0])?void 0:t.title))&&de.value.length>0&&!T.value&&!A.value})),me=i((()=>e.hideNoData&&!de.value.length||e.readonly||(null==ae?void 0:ae.isReadonly.value))),fe=f(),he=Be(fe,P);return _(B,((t,a)=>{if(!t&&t!==a&&(G.value=-1,Y.value=!1,re.value)){if(e.multiple)return void h(Xe(e,re.value));if(!ne.value)return;te.value.some((e=>{let{title:t}=e;return t===re.value}))?oe.value="":h(Xe(e,re.value))}})),_(Y,(()=>{if(!e.hideSelected&&Y.value&&te.value.length){const t=de.value.findIndex((t=>te.value.some((a=>e.valueComparator(a.value,t.value)))));F&&window.requestAnimationFrame((()=>{var e;t>=0&&(null==(e=j.value)||e.scrollToIndex(t))}))}})),_((()=>e.items),((e,t)=>{Y.value||B.value&&!t.length&&e.length&&(Y.value=!0)})),r((()=>{const t=!!(!e.hideNoData||de.value.length||D["prepend-item"]||D["append-item"]||D["no-data"]),r=te.value.length>0,i=Ze.filterProps(e);return u(Ze,v({ref:P},i,{modelValue:re.value,"onUpdate:modelValue":[e=>re.value=e,b],focused:B.value,"onUpdate:focused":e=>B.value=e,validationValue:te.externalValue,counterValue:ue.value,dirty:r,class:["v-combobox",{"v-combobox--active-menu":Y.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!ne.value,"v-combobox--selecting-index":G.value>-1,["v-combobox--"+(e.multiple?"multiple":"single")]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:r?void 0:e.placeholder,"onClick:clear":a,"onMousedown:control":l,onKeydown:s}),{...D,default:()=>u(m,null,[u(et,v({ref:O,modelValue:Y.value,"onUpdate:modelValue":e=>Y.value=e,activator:"parent",contentClass:"v-combobox__content",disabled:me.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:c,onAfterLeave:p},e.menuProps),{default:()=>[t&&u(tt,v({ref:fe,selected:ve.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onKeydown:o,onFocusin:g,onFocusout:y,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},he,e.listProps),{default:()=>{var t,a,l;return[null==(t=D["prepend-item"])?void 0:t.call(D),!de.value.length&&!e.hideNoData&&((null==(a=D["no-data"])?void 0:a.call(D))??u(at,{title:C(e.noDataText)},null)),u(Te,{ref:j,renderless:!0,items:de.value},{default:t=>{var a;let{item:l,index:n,itemRef:o}=t;const r=v(l.props,{ref:o,key:n,active:!(!pe.value||0!==n)||void 0,onClick:()=>h(l,null)});return(null==(a=D.item)?void 0:a.call(D,{item:l,index:n,props:r}))??u(at,v(r,{role:"option"}),{prepend:t=>{let{isSelected:a}=t;return u(m,null,[e.multiple&&!e.hideSelected?u(Ae,{key:l.value,modelValue:a,ripple:!1,tabindex:"-1"},null):void 0,l.props.prependAvatar&&u(lt,{image:l.props.prependAvatar},null),l.props.prependIcon&&u(Ye,{icon:l.props.prependIcon},null)])},title:()=>{var e,t;return T.value?l.title:function(e,t,a){if(null==t)return e;if(Array.isArray(t))throw Error("Multiple matches is not implemented");return"number"==typeof t&&~t?u(m,null,[u("span",{class:"v-combobox__unmask"},[e.substr(0,t)]),u("span",{class:"v-combobox__mask"},[e.substr(t,a)]),u("span",{class:"v-combobox__unmask"},[e.substr(t+a)])]):e}(l.title,null==(e=ie(l))?void 0:e.title,(null==(t=re.value)?void 0:t.length)??0)}})}}),null==(l=D["append-item"])?void 0:l.call(D)]}})]}),te.value.map(((t,a)=>{function l(e){e.stopPropagation(),e.preventDefault(),h(t,!1)}const n={"onClick:close":l,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),l(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},o=le.value?!!D.chip:!!D.selection,r=o?z(le.value?D.chip({item:t,index:a,props:n}):D.selection({item:t,index:a})):void 0;if(!o||r)return u("div",{key:t.value,class:["v-combobox__selection",a===G.value&&["v-combobox__selection--selected",X.value]],style:a===G.value?ee.value:{}},[le.value?D.chip?u(H,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:t.title}}},{default:()=>[r]}):u(Me,v({key:"chip",closable:e.closableChips,size:"small",text:t.title,disabled:t.props.disabled},n),null):r??u("span",{class:"v-combobox__selection-text"},[t.title,e.multiple&&te.value.length-1>a&&u("span",{class:"v-combobox__selection-comma"},[w(",")])])])}))]),"append-inner":function(){for(var t,a=arguments.length,l=Array(a),o=0;a>o;o++)l[o]=arguments[o];return u(m,null,[null==(t=D["append-inner"])?void 0:t.call(D,...l),e.hideNoData&&!e.items.length||!e.menuIcon?void 0:u(Ye,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:n,onClick:R,"aria-label":C(K.value),title:C(K.value),tabindex:"-1"},null)])}})})),I({isFocused:B,isPristine:T,menu:Y,search:re,selectionIndex:G,filteredItems:se,select:h},P)}}),bt=e({modelValue:null,color:String,cancelText:{type:String,default:"$vuetify.confirmEdit.cancel"},okText:{type:String,default:"$vuetify.confirmEdit.ok"}},"VConfirmEdit"),xt=l()({name:"VConfirmEdit",props:bt(),emits:{cancel:()=>!0,save:e=>!0,"update:modelValue":e=>!0},setup(e,t){function a(){s.value=d.value,n("save",d.value)}function l(){d.value=structuredClone(Y(s.value)),n("cancel")}let{emit:n,slots:o}=t;const s=$(e,"modelValue"),d=f();N((()=>{d.value=structuredClone(Y(s.value))}));const{t:c}=V(),v=i((()=>G(s.value,d.value)));let p=!1;return r((()=>{var t;const n=u(m,null,[u(ee,{disabled:v.value,variant:"text",color:e.color,onClick:l,text:c(e.cancelText)},null),u(ee,{disabled:v.value,variant:"text",color:e.color,onClick:a,text:c(e.okText)},null)]);return u(m,null,[null==(t=o.default)?void 0:t.call(o,{model:d,save:a,cancel:l,isPristine:v.value,get actions(){return p=!0,n}}),!p&&n])})),{save:a,cancel:l,isPristine:v}}}),wt={class:"container"},St={class:"d-sm-flex"},kt="/webdav/manage/list",Vt=qe({__name:"webdav",setup(e){const t=B("axios"),a=f({page:1,itemsPerPage:25,type:"",kw:""}),l=[{title:"名称",key:"name",sortable:!1},{title:"网盘类型",key:"type",width:100,sortable:!1},{title:"更新时间",key:"updatedAt",width:180,align:"center",sortable:!1},{title:"操作",key:"actions",align:"end",sortable:!1,width:"80px"}],n=f([]),o=f({items:[],total:0}),r=f(!1),s=async e=>{r.value=!0;try{o.value=await t.get(kt,{params:Object.assign({},e,a.value)})}catch{}finally{r.value=!1}},i=async()=>{r.value=!0;try{await t.delete(kt,{data:{ids:n.value}}),n.value=[],await s(a.value)}catch{}finally{r.value=!1}},d=async()=>{r.value=!0;try{await t.put(kt,m.value),await s(a.value),c.value=!1}catch(e){edit.msg=e.message||"修改失败，请稍后再试"}finally{r.value=!1}},c=f(!1),p=f(null),m=f({}),b=f(null);return(e,t)=>{const f=ft,k=ct;return h(),T("div",wt,[u(dt,{class:"h-100",page:S(a).page,"onUpdate:page":t[6]||(t[6]=e=>S(a).page=e),"items-per-page":S(a).itemsPerPage,"onUpdate:itemsPerPage":t[7]||(t[7]=e=>S(a).itemsPerPage=e),headers:l,items:S(o).items,"items-length":S(o).total,loading:S(r),"onUpdate:options":s,hover:"",fixedHeader:"",fixedFooter:"",hideDefaultHeader:!1,"show-select":"",modelValue:S(n),"onUpdate:modelValue":t[8]||(t[8]=e=>A(n)?n.value=e:null)},{top:y((()=>[u(Oe,{class:"pl-4 pr-4",flat:"",density:"compact"},{default:y((()=>[u(Ye,{icon:"mdi-list-box"}),W("div",St,[u(Ze,{width:"200",class:"ml-2",modelValue:S(a).kw,"onUpdate:modelValue":t[0]||(t[0]=e=>S(a).kw=e),modelModifiers:{lazy:!0},density:"compact",label:"关键词","prepend-inner-icon":"mdi-magnify",variant:"solo-filled",flat:"","hide-details":"","single-line":"","onClick:prependInner":t[1]||(t[1]=e=>s(S(a))),onKeydown:t[2]||(t[2]=q((e=>s(S(a))),["enter"]))},null,8,["modelValue"]),u(yt,{width:"110",class:"ml-2",modelValue:S(a).type,"onUpdate:modelValue":t[3]||(t[3]=e=>S(a).type=e),density:"compact",label:"类型",items:["a123","a189","a115","uc","quark"],variant:"solo-filled",flat:"","hide-details":"","single-line":""},null,8,["modelValue"])]),u(ee,{class:"ml-2",icon:"mdi-magnify",density:"comfortable",variant:"text",onClick:t[4]||(t[4]=x((e=>s(S(a))),["stop"]))}),u(nt),u(f),u(k,{title:"警告",text:"此操作不可逆！",confirm:i},{btn:y((({dialog:e})=>[u(ee,v({class:"mr-2",icon:"mdi-delete",density:"comfortable",variant:"text",disabled:!S(n).length||S(r)},e),null,16,["disabled"])])),_:1})])),_:1})])),"item.updatedAt":y((({item:e})=>[w(K(e.updatedAt?S(ht)(e.updatedAt).format("YYYY-MM-DD HH:mm:ss"):""),1)])),"item.actions":y((({item:e})=>[u(ee,{icon:"mdi-pencil",density:"comfortable",size:"small",variant:"text",onClick:t=>m.value=e,onMouseenter:t[5]||(t[5]=e=>p.value=e.currentTarget)},null,8,["onClick"])])),_:1},8,["page","items-per-page","items","items-length","loading","modelValue"]),u(ae,{modelValue:S(c),"onUpdate:modelValue":t[11]||(t[11]=e=>A(c)?c.value=e:null),activator:S(p),"max-width":"500"},{default:y((()=>[u(xt,{modelValue:S(m),"onUpdate:modelValue":t[9]||(t[9]=e=>A(m)?m.value=e:null),"cancel-text":"取消","ok-text":"更新",onCancel:t[10]||(t[10]=e=>c.value=!1),onSave:d},{default:y((({model:e,actions:t})=>[u(Z,{title:"修改目录名称"},{actions:y((()=>[u(nt),(h(),g(J(t)))])),default:y((()=>[u(X,null,{default:y((()=>[u(Ze,{modelValue:e.value.name,"onUpdate:modelValue":t=>e.value.name=t,variant:"underlined",rules:[e=>!!e||"名称不能为空"],"error-messages":S(b),error:!!S(b)},null,8,["modelValue","onUpdate:modelValue","rules","error-messages","error"])])),_:2},1024)])),_:2},1024)])),_:1},8,["modelValue"])])),_:1},8,["modelValue","activator"])])}}},[["__scopeId","data-v-6ceff5bb"]]);export{Vt as default};
